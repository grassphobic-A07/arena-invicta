{% extends 'base.html' %}
{% load static %}

{% block main_padding %}pt-6 pb-12 md:pt-8 md:pb-20{% endblock %}
{% block title %}Sports News - Arena Invicta{% endblock title %}

{% block hero %}
<section class="group relative w-full overflow-hidden bg-surface">
    
    <div class="slider-wrapper flex w-full transition-transform duration-500 ease-in-out">
        
        {% if featured_news %}
            {% for news_item in featured_news %}
            <a href="{% url 'news:detail_news' news_item.id %}" class="slide min-w-full block relative">
                
                {% if news_item.thumbnail %}
                    <div class="relative h-[300px] md:h-[400px] lg:h-[500px] w-full bg-cover bg-center" style="background-image: url('{{ news_item.thumbnail }}');">
                {% else %}
                    <div class="relative h-[300px] md:h-[400px] lg:h-[500px] w-full bg-gradient-to-r from-primary to-sea">
                {% endif %}
                    
                    <div class="absolute inset-0 bg-gradient-to-t from-[#1A103C] via-[#1A103C]/20 to-transparent"></div>

                    <div class="absolute inset-0 flex flex-col justify-end pb-12 md:pb-16">
                        <div class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <span class="inline-block bg-secondary/80 backdrop-blur-md text-white text-xs font-bold uppercase tracking-wider mb-3 px-3 py-1 rounded-md border border-white/10 shadow-lg">
                                {{ news_item.get_sports_display }}
                            </span>
                            <h1 class="text-4xl md:text-5xl lg:text-7xl font-extrabold text-white leading-tight mb-2 drop-shadow-lg max-w-4xl line-clamp-2">
                                {{ news_item.title|upper }}
                            </h1>
                        </div>
                    </div>
                </div>
            </a>
            {% endfor %}
        {% else %}
            <div class="slide min-w-full relative">
                <div class="relative h-[500px] lg:h-[650px] w-full bg-gradient-to-r from-gray-900 to-primary flex flex-col justify-end pb-12 md:pb-16">
                     <div class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <h1 class="text-4xl font-bold text-white">NO HOT NEWS AVAILABLE</h1>
                    </div>
                </div>
            </div>
        {% endif %}

    </div>
    
    {% if featured_news|length > 1 %}
    <div class="absolute inset-0 pointer-events-none flex items-center justify-between w-full max-w-[90rem] mx-auto px-4 top-0">
        <button id="prev-btn" class="pointer-events-auto h-12 w-12 rounded-full bg-black/20 hover:bg-primary/80 backdrop-blur-sm border border-white/10 text-white flex items-center justify-center transition-all focus:outline-none opacity-0 group-hover:opacity-100 transform -translate-x-4 group-hover:translate-x-0 duration-300">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        </button>
        <button id="next-btn" class="pointer-events-auto h-12 w-12 rounded-full bg-black/20 hover:bg-primary/80 backdrop-blur-sm border border-white/10 text-white flex items-center justify-center transition-all focus:outline-none opacity-0 group-hover:opacity-100 transform translate-x-4 group-hover:translate-x-0 duration-300">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        </button>
    </div>
    {% endif %}

</section>
{% endblock hero %}


{% block content %}
    
    <div class="flex justify-center flex-wrap gap-2 mb-8 mt-4">
        <a href="{% url 'news:show_news' %}" 
           class="px-5 py-2.5 rounded-full text-sm font-semibold transition-all duration-300
                  {% if current_filter == 'all' %} bg-gradient-to-r from-primary to-secondary text-white shadow-lg shadow-primary/30 scale-105 {% else %} bg-white/5 text-gray-300 hover:bg-white/10 hover:text-white border border-white/5 {% endif %}">
            All Sports
        </a>
        {% for choice_value, choice_label in all_sports %}
            <a href="{% url 'news:show_news' %}?filter={{ choice_value }}"
               class="px-5 py-2.5 rounded-full text-sm font-semibold transition-all duration-300 capitalize
                      {% if current_filter == choice_value %} bg-gradient-to-r from-primary to-secondary text-white shadow-lg shadow-primary/30 scale-105 {% else %} bg-white/5 text-gray-300 hover:bg-white/10 hover:text-white border border-white/5 {% endif %}">
                {{ choice_label }}
            </a>
        {% endfor %}
    </div>

    <div class="flex justify-end mb-6">
        {% if request.user.is_authenticated and request.user.profile.is_content_staff %}
            <button type="button" 
                    onclick="showNewsModal()"
                    class="inline-flex items-center gap-2 h-10 px-5 rounded-xl text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-secondary/50 bg-white/10 hover:bg-white/20 text-white border border-white/10 hover:border-white/30 backdrop-blur-md">
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 5v14"/><path d="M5 12h14"/>
                </svg>
                <span>Add News</span>
            </button>
        {% endif %}
    </div>

    <div id="news-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        {% for news in news_list %}
            <a href="{% url 'news:detail_news' news.id %}" class="group block relative overflow-hidden rounded-2xl bg-surface border border-white/5 shadow-xl hover:shadow-primary/20 transition-all duration-300 hover:-translate-y-1">
                {% if news.thumbnail %}
                <div class="relative w-full aspect-[4/3] bg-cover bg-center transition-transform duration-500 group-hover:scale-110" style="background-image: url('{{ news.thumbnail }}');">
                {% else %}
                <div class="relative w-full aspect-[4/3] bg-gradient-to-br from-surface to-dark transition-transform duration-500 group-hover:scale-110">
                {% endif %}
                    <div class="absolute inset-0 bg-gradient-to-t from-[#1A103C] via-transparent to-transparent opacity-80 group-hover:opacity-90 transition-opacity"></div>
                    
                    <div class="absolute top-4 left-4">
                         <span class="inline-block bg-secondary/50 backdrop-blur-md text-white text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded border border-white/10">
                            {{ news.get_sports_display }}
                        </span>
                    </div>

                    <div class="absolute bottom-0 left-0 p-5 w-full">
                        <h3 class="text-white text-lg font-bold leading-snug line-clamp-2 group-hover:text-secondary transition-colors">
                            {{ news.title|upper }}
                        </h3>
                        <p class="text-gray-400 text-xs mt-2 flex items-center gap-2">
                           <span>{{ news.created_at|date:"d M Y" }}</span>
                        </p>
                    </div>
                </div>
            </a>
        {% empty %}
            <div id="no-news-message" class="col-span-full flex flex-col items-center justify-center py-20 text-center border-2 border-dashed border-white/10 rounded-3xl bg-white/5">
                <div class="w-16 h-16 bg-white/5 rounded-full flex items-center justify-center mb-4">
                    <svg class="w-8 h-8 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path></svg>
                </div>
                <p class="text-white font-medium text-lg">No news found</p>
                <p class="text-gray-400 text-sm">Try adjusting your filters.</p>
            </div>
        {% endfor %}
    </div>

    {% include 'modal.html' %}
{% endblock content %}

{% block scripts %}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const sliderWrapper = document.querySelector('.slider-wrapper');
            if (!sliderWrapper) return;

            const slides = sliderWrapper.querySelectorAll('.slide');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            let currentIndex = 0;
            const totalSlides = slides.length;

            if (totalSlides > 1) {
                function goToSlide(index) {
                    if (index < 0) {
                        currentIndex = totalSlides - 1;
                    } else if (index >= totalSlides) {
                        currentIndex = 0;
                    } else {
                        currentIndex = index;
                    }
                    
                    const offset = -currentIndex * 100;
                    sliderWrapper.style.transform = `translateX(${offset}%)`;
                }

                nextBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    goToSlide(currentIndex + 1);
                });

                prevBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    goToSlide(currentIndex - 1);
                });

                // Auto slide
                let autoSlideInterval = setInterval(() => {
                    goToSlide(currentIndex + 1);
                }, 5000);

                // Pause on hover
                const sliderContainer = sliderWrapper.closest('section');
                sliderContainer.addEventListener('mouseenter', () => {
                    clearInterval(autoSlideInterval);
                });
                sliderContainer.addEventListener('mouseleave', () => {
                    autoSlideInterval = setInterval(() => {
                        goToSlide(currentIndex + 1);
                    }, 5000);
                });
            }
        });
    </script>
{% endblock scripts %}