{% with profile=thread.author_profile %}
<article class="flex h-full flex-col gap-4 rounded-2xl border border-surface/15 bg-white/95 p-5 shadow-sm transition hover:-translate-y-0.5 hover:shadow-md">
  <header class="flex items-start gap-3">
    {% if profile and profile.avatar_url %}
      <img src="{{ profile.avatar_url }}" alt="{{ thread.author_display }}" class="h-12 w-12 rounded-full object-cover ring-2 ring-mist/80">
    {% else %}
      {% with initials=thread.author_display %}
        <div class="grid h-12 w-12 place-items-center rounded-full bg-mint/40 text-sm font-semibold uppercase text-primary ring-2 ring-mist/80">
          {{ initials|slice:":2" }}
        </div>
      {% endwith %}
    {% endif %}
    <div class="min-w-0 space-y-1">
      {% if thread.is_pinned %}
        <span class="inline-flex items-center gap-1 rounded-full bg-mint/30 px-2 py-0.5 text-[11px] font-semibold uppercase tracking-wide text-primary">
          <svg class="h-3 w-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 17V3"></path>
            <path d="m5 11 7 6 7-6"></path>
          </svg>
          Pinned
        </span>
      {% endif %}
      <a href="{% url 'discussions:thread-detail' thread.pk %}" class="block text-base font-semibold text-primary transition hover:text-sea line-clamp-2">
        {{ thread.title }}
      </a>
      <p class="text-xs text-surface/50">
        {{ thread.author_display }} · {{ thread.created_at|date:"j M Y · H.i" }}
      </p>
    </div>
  </header>

  {% if thread.is_locked %}
    <div class="flex items-center gap-2 rounded-lg border border-danger/40 bg-danger/5 px-3 py-1 text-[11px] font-medium uppercase tracking-wide text-danger">
      <svg class="h-3.5 w-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M6 10V8a6 6 0 1 1 12 0v2"></path>
        <rect width="18" height="12" x="3" y="10" rx="2"></rect>
      </svg>
      Thread Terkunci
    </div>
  {% endif %}

  <p class="text-sm text-surface/70 line-clamp-3">{{ thread.body }}</p>

  <footer class="mt-auto flex flex-col gap-3 text-xs text-surface/60">
    <div class="flex flex-col gap-1">
      {% if thread.news %}
        <a href="{% url 'news:detail_news' thread.news_id %}" class="group inline-flex items-center gap-2 text-primary transition hover:text-primary/80">
          <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 4h18v16H3z"></path>
            <path d="M7 8h10"></path>
            <path d="M7 12h10"></path>
            <path d="M7 16h4"></path>
          </svg>
          <span class="line-clamp-1">{{ thread.news.title }}</span>
        </a>
        <span class="text-[11px] text-surface/40">UUID: {{ thread.news_id }}</span>
        {% with snippet=thread.news.content %}
          {% if snippet %}
            <p class="text-[11px] text-surface/50 line-clamp-2">{{ snippet|truncatewords:24 }}</p>
          {% endif %}
        {% endwith %}
      {% else %}
        <span class="text-xs italic text-surface/50">Berita terkait tidak ditemukan.</span>
      {% endif %}
    </div>
    <div class="flex flex-wrap items-center gap-4 text-[11px] font-semibold uppercase tracking-wide text-surface/60">
      <span class="inline-flex items-center gap-1">
        <svg class="h-3.5 w-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>
        {{ thread.comment_count|default:thread.comments.count }} komentar
      </span>
      <span class="inline-flex items-center gap-1">
        <svg class="h-3.5 w-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M5 15l7-12 7 12"></path>
          <path d="M5 21h14"></path>
        </svg>
        {{ thread.upvote_count|default:thread.upvotes.count }} upvote
      </span>
      <span class="inline-flex items-center gap-1">
        <svg class="h-3.5 w-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
          <circle cx="12" cy="12" r="3"></circle>
        </svg>
        {{ thread.views_count }} views
      </span>
    </div>
  </footer>
</article>
{% endwith %}
